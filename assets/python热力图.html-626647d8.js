import{_ as p,V as o,W as i,X as l,Y as n,Z as s,a0 as t,a2 as e,F as c}from"./framework-82b537ca.js";const r="/carefree/python/hotmap/cmd.jpg",u="/carefree/python/hotmap/vscode1.png",d="/carefree/python/hotmap/vscode2.png",k="/carefree/python/hotmap/vscode3.png",m="/carefree/python/hotmap/vscode4.png",v="/carefree/python/hotmap/vscode5.png",b="/carefree/python/hotmap/vscode6.png",h="/carefree/python/hotmap/magma_9.png",_={},g=n("p",null,"教我家大宝怎么用python绘制热力图",-1),f=e('<p>完事开头难，先准备环境和工具</p><h2 id="在windows安装python" tabindex="-1"><a class="header-anchor" href="#在windows安装python" aria-hidden="true">#</a> 在windows安装python</h2><p>同时按住 <strong>window + r</strong> 键，输入 <strong>cmd</strong>，或者直接搜索cmd，打开如下界面：</p><figure><img src="'+r+`" alt="cmd界面" tabindex="0" loading="lazy"><figcaption>cmd界面</figcaption></figure><p>输入命令如下：</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>python --version
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果能够正确显示python版本，则无需进行下一步。如果不能，请接着操作。</p>`,7),y={href:"https://www.python.org/downloads/",target:"_blank",rel:"noopener noreferrer"},w=n("li",null,"按照流程安装，c盘即可.",-1),x=n("li",null,"配置path环境变量，文件管理器-我的电脑-右键点击-属性-环境变量-系统变量-path-编辑(一般都用不着)",-1),M=n("h2",{id:"安装vscode代码编辑器",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装vscode代码编辑器","aria-hidden":"true"},"#"),s(" 安装vscode代码编辑器")],-1),L={href:"https://vscode.github.net.cn/",target:"_blank",rel:"noopener noreferrer"},j=e('<figure><img src="'+u+'" alt="打开插件管理" tabindex="0" loading="lazy"><figcaption>打开插件管理</figcaption></figure><figure><img src="'+d+'" alt="安装python插件" tabindex="0" loading="lazy"><figcaption>安装python插件</figcaption></figure><h2 id="准备文件夹和文件" tabindex="-1"><a class="header-anchor" href="#准备文件夹和文件" aria-hidden="true">#</a> 准备文件夹和文件</h2><ol><li>找一个地方新建文件夹，命名随意，假设它叫做<strong>hotmap</strong>，将数据表格比如<strong>yMGL-vs-yMGL_Met.pheatmap.order.xlsx</strong>等拷贝过来</li><li>使用vscode打开这个文件，如下图：</li></ol><figure><img src="'+k+'" alt="vscode打开文件夹" tabindex="0" loading="lazy"><figcaption>vscode打开文件夹</figcaption></figure>',5),G={start:"3"},q={href:"http://datas.py",target:"_blank",rel:"noopener noreferrer"},E=n("figure",null,[n("img",{src:m,alt:"新建文件",tabindex:"0",loading:"lazy"}),n("figcaption",null,"新建文件")],-1),z={start:"4"},N={href:"http://xn--do-xg3ck12duwh8g.py",target:"_blank",rel:"noopener noreferrer"},B=n("strong",null,"hotmap",-1),D={href:"http://datas.xn--pydo-c65fh3x.py",target:"_blank",rel:"noopener noreferrer"},V=e('<figure><img src="'+v+`" alt="文件列表" tabindex="0" loading="lazy"><figcaption>文件列表</figcaption></figure><h2 id="编辑datas-py文件-处理数据" tabindex="-1"><a class="header-anchor" href="#编辑datas-py文件-处理数据" aria-hidden="true">#</a> 编辑datas.py文件，处理数据</h2><p>首先需要安装依赖包，请依次在<a href="#%E5%9C%A8windows%E5%AE%89%E8%A3%85python">在windows安装python</a>步骤中打开的cmd界面执行如下命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> pandas
pip <span class="token function">install</span> seaborn
pip <span class="token function">install</span> matplotlib
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>开始编辑代码</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> json

<span class="token comment"># 假设文件名为 &quot;yMGL-vs-yMGL_Met.pheatmap.order.xlsx&quot;，请替换为你的实际文件名</span>
file_name <span class="token operator">=</span> <span class="token string">&quot;yMGL-vs-yMGL_Met.pheatmap.order.xlsx&quot;</span>

<span class="token comment"># 读取excel文件</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span>

<span class="token comment"># 获取前50行数据 按需修改</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>

<span class="token comment"># 获取前50行数据的第一列（gene_id）</span>
gene_ids <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;gene_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据保存为JSON文件</span>
json_file_name <span class="token operator">=</span> <span class="token string">&quot;yMGL-vs-yMGL_Met.pheatmap.order_ids.json&quot;</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>json_file_name<span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_file<span class="token punctuation">:</span>
    json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>gene_ids<span class="token punctuation">,</span> json_file<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment"># 从第二列开始提取数据，并转换为二维数组</span>
array_2d <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values

<span class="token comment"># 将二维数组转换为列表</span>
array_2d_list <span class="token operator">=</span> array_2d<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据保存为JSON文件</span>
json_file_name <span class="token operator">=</span> <span class="token string">&quot;yMGL-vs-yMGL_Met.pheatmap.order_data.json&quot;</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>json_file_name<span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_file<span class="token punctuation">:</span>
    json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>array_2d_list<span class="token punctuation">,</span> json_file<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Data has been saved to </span><span class="token interpolation"><span class="token punctuation">{</span>json_file_name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),F={href:"http://xn--vscodedatas-518qy74g256au14i.py",target:"_blank",rel:"noopener noreferrer"},I=n("figure",null,[n("img",{src:b,alt:"文件列表",tabindex:"0",loading:"lazy"}),n("figcaption",null,"文件列表")],-1),C=n("p",null,[s("操作将会在hotmap文件夹中生成两个文件： "),n("strong",null,"yMGL-vs-yMGL_Met.pheatmap.order_ids.json"),s("以及"),n("strong",null,"yMGL-vs-yMGL_Met.pheatmap.order_data.json"),s(" 这两个文件就是等会需要用到的内容。")],-1),P={id:"编辑do-py",tabindex:"-1"},S=n("a",{class:"header-anchor",href:"#编辑do-py","aria-hidden":"true"},"#",-1),T={href:"http://xn--do-xm3f159c.py",target:"_blank",rel:"noopener noreferrer"},A=e(`<p>现在数据已经处理成想要的了，接下来将会使用它们去绘制图像：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> json <span class="token operator">//</span>json处理包
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns <span class="token operator">//</span> 图形处理包
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token operator">//</span> 图形生成包
<span class="token keyword">from</span> palettable<span class="token punctuation">.</span>colorbrewer<span class="token punctuation">.</span>sequential <span class="token keyword">import</span> Blues_9 <span class="token operator">//</span>色盘

<span class="token comment"># 从 JSON 文件中读取数据</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;yMGL-vs-yMGL_Met.pheatmap.order_data.json&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token comment"># 从 ID 文件中读取纵坐标</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;yMGL-vs-yMGL_Met.pheatmap.order_ids.json&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    ids <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据转换为 DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 检查数据维度是否匹配</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span> <span class="token operator">!=</span> df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&quot;The number of IDs does not match the number of rows in the data.&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 设置 DataFrame 的索引为 ID 列表</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> ids

<span class="token comment"># 生成热力图</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df<span class="token punctuation">,</span> cmap<span class="token operator">=</span>Blues_9<span class="token punctuation">.</span>mpl_colormap<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;.1f&#39;</span><span class="token punctuation">,</span> xticklabels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;fpkm_yMGL1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;fpkm_yMGL2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;fpkm_yMGL3&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;fpkm_yMGL_Met_3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;fpkm_yMGL_Met_2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;fpkm_yMGL_Met_1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> linewidths<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> linecolor<span class="token operator">=</span><span class="token string">&#39;lightgrey&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span> 
<span class="token operator">//</span> 其中 cmap 为色盘值，可以选择多种色盘组合
<span class="token operator">//</span> linewidths为每格的间隔线宽度 linecolor 为颜色


<span class="token comment"># 设置字体为 Times New Roman</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.family&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;serif&#39;</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.serif&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Times New Roman&#39;</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;axes.unicode_minus&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决负号显示问题</span>

<span class="token comment"># 设置字体加粗和字号</span>
<span class="token keyword">for</span> label <span class="token keyword">in</span> ax<span class="token punctuation">.</span>get_xticklabels<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> ax<span class="token punctuation">.</span>get_yticklabels<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    label<span class="token punctuation">.</span>set_fontsize<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># 设置字体大小</span>
    label<span class="token punctuation">.</span>set_fontweight<span class="token punctuation">(</span><span class="token string">&#39;bold&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 设置字体加粗</span>

plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&#39;heatmap.png&#39;</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>  <span class="token comment"># 增加 DPI 值</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同上运行，运行后即可看到生成的热力图</p><h2 id="使用色盘进行调色" tabindex="-1"><a class="header-anchor" href="#使用色盘进行调色" aria-hidden="true">#</a> 使用色盘进行调色</h2>`,4),J={href:"https://jiffyclub.github.io/palettable/matplotlib/",target:"_blank",rel:"noopener noreferrer"},O=n("a",{href:"#%E7%BC%96%E8%BE%91dopy"},"编辑do.py",-1),R=e(`<ol><li>在网址中找到一个色盘，比如我这里使用科学绘图常见的palettable.matplotlib，则替换代码：</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>delete <span class="token keyword">from</span> palettable<span class="token punctuation">.</span>colorbrewer<span class="token punctuation">.</span>sequential <span class="token keyword">import</span> Blues_9 <span class="token operator">//</span>色盘
add <span class="token keyword">from</span> <span class="token keyword">from</span> palettable<span class="token punctuation">.</span>matplotlib <span class="token keyword">import</span> Magma_9
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>在网址中找到matplotlib中的某个色系，比如Magma_9</li></ol><p>点击运行绘制图案：</p><figure><img src="`+h+'" alt="Magma_9" tabindex="0" loading="lazy"><figcaption>Magma_9</figcaption></figure>',5);function W(X,Y){const a=c("ExternalLinkIcon");return o(),i("div",null,[g,l("more"),f,n("ol",null,[n("li",null,[s("前往"),n("a",y,[s("python"),t(a)]),s("官网下载.")]),w,x]),M,n("p",null,[n("a",L,[s("官网"),t(a)]),s("下载安装，切记不要安装在c盘，安装好后打开，有如下界面，按照图中箭头操作：")]),j,n("ol",G,[n("li",null,[s("新建文件"),n("strong",null,[n("a",q,[s("datas.py"),t(a)])]),s(":")])]),E,n("ol",z,[n("li",null,[s("同上，"),n("a",N,[s("新建文件do.py"),t(a)])])]),n("p",null,[s("现在，你的"),B,s("文件夹下将有至少两个文件 "),n("a",D,[s("datas.py以及do.py"),t(a)]),s("。以及拷贝进来的其它.xslx表格文件，形式大概如下：")]),V,n("p",null,[n("a",F,[s("在vscode中执行datas.py"),t(a)]),s("，如下：")]),I,C,n("h2",P,[S,s(),n("a",T,[s("编辑do.py"),t(a)])]),A,n("p",null,[s("访问"),n("a",J,[s("https://jiffyclub.github.io/palettable/matplotlib/"),t(a)]),s("查看标准色盘，选择一个替换掉"),O,s("中cmap的值，以下是一个示例：")]),R])}const H=p(_,[["render",W],["__file","python热力图.html.vue"]]);export{H as default};
